<!-- Monthly Prayer Times - Collapsible Section -->
<div class="w-full px-4 md:px-8 lg:px-12" data-controller="collapse">
  <!-- Collapse Toggle Button -->
  <button class="w-full backdrop-blur-md bg-base-100/50 rounded-2xl p-4 border border-white/10 shadow-lg transition-all duration-300 hover:bg-base-100/70 group" type="button" data-action="click->collapse#toggle" data-collapse-target="button">
    <div class="flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="bg-primary/20 text-primary rounded-xl p-2">
          <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"/>
          </svg>
        </div>
        <div class="text-left">
          <h3 class="font-bold text-base md:text-lg">Jadual Bulanan</h3>
          <p class="text-xs text-base-content/60"><%= @monthly.count %> hari waktu solat</p>
        </div>
      </div>
      <div class="flex items-center gap-2">
        <span class="text-xs text-base-content/50 hidden md:inline" data-collapse-target="label">Tunjuk</span>
        <div class="bg-base-200 rounded-full p-2 transition-transform duration-300" data-collapse-target="icon">
          <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"/>
          </svg>
        </div>
      </div>
    </div>
  </button>

  <!-- Collapsible Content -->
  <div class="overflow-hidden transition-all duration-500 ease-in-out" data-collapse-target="content" style="max-height: 0;">
    <div class="pt-4 space-y-2">
      <!-- Table Header - Desktop -->
      <div class="hidden md:grid md:grid-cols-9 gap-2 p-3 bg-base-200/50 rounded-xl text-xs font-semibold uppercase tracking-wider text-base-content/60">
        <div class="col-span-1">Tarikh</div>
        <% prayers.each do |prayer| %>
          <div class="text-center"><%= prayer[:label] %></div>
        <% end %>
      </div>

      <!-- Prayer Times List -->
      <% @monthly.each do |month| %>
        <% date = month["date"].to_date %>
        <% is_today = date == Date.current %>
        <% is_friday = date.friday? %>

        <div class="group rounded-xl p-3 transition-all duration-200 border <%= is_today ? 'bg-primary text-primary-content border-primary shadow-lg scale-[1.02]' : 'bg-base-100/50 border-white/5 hover:bg-base-100/80' %>">
          <!-- Mobile View -->
          <div class="md:hidden">
            <div class="flex items-center justify-between mb-3">
              <div class="flex items-center gap-2">
                <% if is_today %>
                  <div class="badge badge-secondary badge-sm">Hari Ini</div>
                <% elsif is_friday %>
                  <div class="badge badge-accent badge-sm badge-outline">Jumaat</div>
                <% end %>
                <div class="font-bold"><%= l date, format: :day %></div>
                <span class="text-sm"><%= l date, format: :long %></span>
              </div>
              <div class="text-xs opacity-70"><%= hijri_date month["hijri"] %></div>
            </div>
            <div class="grid grid-cols-4 gap-2 text-center">
              <% prayers.each do |prayer| %>
                <div class="rounded-lg p-2 <%= is_today ? 'bg-primary-content/10' : 'bg-base-200/50' %> <%= prayer[:key] %>">
                  <div class="text-xs opacity-60"><%= prayer[:label] %></div>
                  <div class="text-sm font-bold tabular-nums"><%= l month[prayer[:key]].to_time, format: "%I:%M" %></div>
                </div>
              <% end %>
            </div>
          </div>

          <!-- Desktop View -->
          <div class="hidden md:grid md:grid-cols-9 gap-2 items-center">
            <div class="col-span-1">
              <div class="flex items-center gap-2">
                <% if is_today %>
                  <div class="badge badge-secondary badge-sm">Hari Ini</div>
                <% elsif is_friday %>
                  <div class="badge badge-accent badge-sm badge-outline">Jumaat</div>
                <% end %>
              </div>
              <div class="font-bold"><%= l date, format: :day %></div>
              <div class="text-sm opacity-80"><%= l date, format: :long %></div>
              <div class="text-xs opacity-60"><%= hijri_date month["hijri"] %></div>
            </div>
            <% prayers.each do |prayer| %>
              <div class="text-center font-semibold tabular-nums <%= prayer[:key] %>">
                <%= l month[prayer[:key]].to_time, format: "%I:%M %p" %>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
