<% content_for :title, "Kalendar Islam" %>
<% content_for :description, "Senarai peristiwa dan tarikh penting dalam kalendar Islam" %>

<div class="container mx-auto px-4 py-8 md:py-12 max-w-2xl">
  <div class="backdrop-blur-md bg-base-100/30 rounded-3xl p-6 md:p-8 border border-white/20 shadow-2xl">

    <!-- Header -->
    <h1 class="text-2xl font-bold text-center mb-2">Kalendar Islam</h1>
    <p class="text-center opacity-60 text-sm mb-6">Peristiwa akan datang dalam tempoh setahun</p>

    <!-- Year Selector -->
    <div class="flex items-center justify-center gap-2 mb-8">
      <% @years.each do |year| %>
        <a href="/calendar?year=<%= year %>"
           class="btn btn-sm <%= year == @selected_year ? 'btn-primary' : 'backdrop-blur-md bg-white/10 border border-white/20 hover:bg-white/20' %>">
          <%= year %>
        </a>
      <% end %>
    </div>

    <!-- Events List -->
    <div class="space-y-3">
      <% @events.each do |event| %>
        <% miladi = Date.parse(event["tarikh_miladi"]) %>
        <% is_today = miladi == Date.current %>
        <% is_past = miladi < Date.current %>
        <div class="flex gap-4 p-4 rounded-2xl border transition-all
                    <%= is_today ? 'bg-primary/10 border-primary/30' : 'bg-white/10 border-white/10 hover:bg-white/20' %>
                    <%= 'opacity-40' if is_past %>">
          <!-- Date -->
          <div class="flex flex-col items-center justify-center min-w-[60px] text-center">
            <span class="text-2xl font-bold tabular-nums <%= 'text-primary' if is_today %>"><%= miladi.day %></span>
            <span class="text-xs uppercase font-semibold opacity-60"><%= I18n.l(miladi, format: :short_month) rescue miladi.strftime("%b") %></span>
            <span class="text-xs opacity-40 tabular-nums"><%= miladi.year %></span>
          </div>

          <!-- Event Details -->
          <div class="flex-1 min-w-0">
            <div class="font-semibold mb-1"><%= event["hari_peristiwa"] %></div>
            <div class="text-xs opacity-60">
              <%= event["tarikh_hijri"] %> H
            </div>
            <% if is_today %>
              <span class="badge badge-primary badge-sm mt-2">Hari Ini</span>
            <% end %>
          </div>
        </div>
      <% end %>

      <% if @events.empty? %>
        <div class="text-center py-12 opacity-60">
          <p>Tiada peristiwa dijumpai.</p>
        </div>
      <% end %>
    </div>
  </div>
</div>
